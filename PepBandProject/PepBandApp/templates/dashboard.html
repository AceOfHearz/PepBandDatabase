<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
  <style>
    /* Basic styling for demonstration purposes */
    #container {
      display: flex;
      justify-content: space-around;
    }
    #studentSearch {
      width: 45%;
      border-right: 1px solid #ccc;
      padding-right: 20px;
    }
    #instrumentSearch {
      width: 45%;
      padding-left: 20px;
    }
    .searchInput {
      padding: 5px;
      margin-bottom: 10px;
      width: 100%;
    }
    .result {
      margin-top: 10px;
    }
    ul {
      list-style-type: none;
      padding-left: 0;
    }
  </style>
</head>
<body>
  <h2>Welcome to the Dashboard</h2>
  <div id="container">
    <div id="studentActions">
      <button onclick="addStudent()">Add Student</button>
      <button onclick="removeStudent()">Remove Student</button>
    </div>
    <div id="instrumentActions">
      <button onclick="addInstrument()">Add Instrument</button>
      <button onclick="removeInstrument()">Remove Instrument</button>
      <button onclick="assignInstrument()">Assign Instrument</button>
    </div>
  </div>
  <div id="studentSearch">
    <h3>Student Search</h3>
    <input type="text" id="studentSearchInput" class="searchInput" placeholder="Search by name" onkeyup="searchStudents()">
    <div id="studentSearchResult" class="result"></div>
  </div>
  <div id="instrumentSearch">
    <h3>Instrument Search</h3>
    <input type="text" id="instrumentSearchInput" class="searchInput" placeholder="Search by name" onkeyup="searchInstruments()">
    <div id="instrumentSearchResult" class="result"></div>
  </div>

  <script>
    const students = [
      { name: "James McInerney", email: "j.j.mcinerney@email.msmary.edu", phone: "(301)-676-7471" },
      { name: "Jack Lawler", email: "j.r.lawler@email.msmary.edu", phone: "215-265-1890" },
      { name: "Kaylee Dembroksi", email: "k.c.dembroski@email.msmary.edu", phone: "240-370-4693" }
    ];

    const instruments = [
      { name: "Trumpet 1", serialNumber: "SB20622001" },
      { name: "Trumpet 2", serialNumber: "SB20622002" },
      { name: "Trumpet 3", serialNumber: "SB20622003" }
    ];

    function searchStudents() {
      const searchTerm = document.getElementById("studentSearchInput").value.toLowerCase();
      const resultDiv = document.getElementById("studentSearchResult");
      resultDiv.innerHTML = ''; // Clear previous results

      const filteredStudents = students.filter(student =>
        student.name.toLowerCase().includes(searchTerm)
      );

      if (searchTerm === '') {
        resultDiv.innerHTML = ''; // Clear results if search input is empty
        return;
      }

      if (filteredStudents.length === 0) {
        resultDiv.innerHTML = 'No matching students found.';
      } else {
        const studentList = document.createElement("ul");
        filteredStudents.forEach(student => {
          const listItem = document.createElement("li");
          listItem.innerHTML = `
            <strong>Name:</strong> ${student.name}<br>
            <strong>Email:</strong> ${student.email}<br>
            <strong>Phone:</strong> ${student.phone}<br><br>
          `;
          studentList.appendChild(listItem);
        });
        resultDiv.appendChild(studentList);
      }
    }

    function searchInstruments() {
      const searchTerm = document.getElementById("instrumentSearchInput").value.toLowerCase();
      const resultDiv = document.getElementById("instrumentSearchResult");
      resultDiv.innerHTML = ''; // Clear previous results

      const filteredInstruments = instruments.filter(instrument =>
        instrument.name.toLowerCase().includes(searchTerm)
      );

      if (searchTerm === '') {
        resultDiv.innerHTML = ''; // Clear results if search input is empty
        return;
      }

      if (filteredInstruments.length === 0) {
        resultDiv.innerHTML = 'No matching instruments found.';
      } else {
        const instrumentList = document.createElement("ul");
        filteredInstruments.forEach(instrument => {
          const listItem = document.createElement("li");
          listItem.innerHTML = `
            <strong>Name:</strong> ${instrument.name}<br>
            <strong>Serial Number:</strong> ${instrument.serialNumber}<br><br>
          `;
          instrumentList.appendChild(listItem);
        });
        resultDiv.appendChild(instrumentList);
      }
    }

    function addStudent() {
      const name = prompt("Enter student's name:");
      const email = prompt("Enter student's email:");
      const phone = prompt("Enter student's phone:");

      if (name && email && phone) {
        // Send a POST request to the server to add the student
        fetch('/add_student/', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken'),
          },
          body: JSON.stringify({ name, email, phone }),
        })
          .then(response => {
            if (response.ok) {
              alert('Student added successfully!');
              window.location.reload();
            } else {
              alert('Failed to add student.');
            }
          })
          .catch(error => console.error('Error:', error));
      }
    }

    function removeStudent() {
      const student_id = prompt("Enter student's ID:");

      if (student_id) {
        // Send a POST request to the server to remove the student
        fetch('/remove_student/', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken'),
          },
          body: JSON.stringify({ student_id }),
        })
          .then(response => {
            if (response.ok) {
              alert('Student removed successfully!');
              window.location.reload();
            } else {
              alert('Failed to remove student.');
            }
          })
          .catch(error => console.error('Error:', error));
      }
    }

    function addInstrument() {
      const name = prompt("Enter instrument's name:");
      const serialNumber = prompt("Enter instrument's serial number:");

      if (name && serialNumber) {
        // Send a POST request to the server to add the instrument
        fetch('/add_instrument/', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken'),
          },
          body: JSON.stringify({ name, serial_number: serialNumber }),
        })
          .then(response => {
            if (response.ok) {
              alert('Instrument added successfully!');
              window.location.reload();
            } else {
              alert('Failed to add instrument.');
            }
          })
          .catch(error => console.error('Error:', error));
      }
    }

    function removeInstrument() {
      const serialNumber = prompt("Enter instrument's serial number:");

      if (serialNumber) {
        // Send a POST request to the server to remove the instrument
        fetch('/remove_instrument/', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken'),
          },
          body: JSON.stringify({ serial_number: serialNumber }),
        })
          .then(response => {
            if (response.ok) {
              alert('Instrument removed successfully!');
              window.location.reload();
            } else {
              alert('Failed to remove instrument.');
            }
          })
          .catch(error => console.error('Error:', error));
      }
    }

    function assignInstrument() {
      const student_id = prompt("Enter student's ID:");
      const serialNumber = prompt("Enter instrument's serial number:");

      if (student_id && serialNumber) {
        // Send a POST request to the server to assign the instrument to the student
        fetch('/assign_instrument/', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken'),
          },
          body: JSON.stringify({ student_id, serial_number: serialNumber }),
        })
          .then(response => {
            if (response.ok) {
              alert('Instrument assigned successfully!');
              window.location.reload();
            } else {
              alert('Failed to assign instrument.');
            }
          })
          .catch(error => console.error('Error:', error));
      }
    }

    function getCookie(name) {
      const value = `; ${document.cookie}`;
      const parts = value.split(`; ${name}=`);
      if (parts.length === 2) return parts.pop().split(';').shift();
    }

    function validatePhoneNumber(event) {
      var charCode = event.which ? event.which : event.keyCode;
      if (charCode > 31 && (charCode < 48 || charCode > 57)) {
        event.preventDefault();
      }
    }
  </script>
  <input type="text" name="phone_number" onkeypress="validatePhoneNumber(event)">
</body>
</html>
